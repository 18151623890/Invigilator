<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.example.invigilator.mapper.LoginMapper">
    <select id="ifUserNameExist" parameterType="java.lang.String" resultType="int">
        select count(*) from user WHERE username = #{userName}
    </select>

    <select id="selectPasswordByUsername" parameterType="java.lang.String" resultType="java.lang.String">
        select password from user where username = #{userName}
    </select>

    <select id="selectUserDtoByUserName" parameterType="java.lang.String" resultType="com.example.invigilator.dto.UserDto">
        SELECT
        `user`.id AS 'userId',
        user_role.rid AS 'roleId',
        role.`name` AS 'roleName',
        user_school.sid AS 'schoolId',
        school.`name` AS 'schoolName',
        `user`.nickname
        FROM
        `user`
        LEFT JOIN user_role ON `user`.id=user_role.uid
        LEFT JOIN role on user_role.rid=role.id
        LEFT JOIN user_school ON user.id=user_school.uid
        LEFT JOIN school on user_school.sid=school.id
        WHERE `user`.username=#{userName}
    </select>
</mapper>